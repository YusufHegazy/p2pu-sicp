;; Depends on 1.37

(define (tan-cf x k)
  (let ((numer (λ (i) 
		  (if (= i 1)
		      x
		      (- (sqr x)))))
	(denom (λ (i) (- (* 2 i) 1))))
    (cont-frac numer denom k)))

(tan-cf (/ pi 4) 5) ; => 0.999999986526355
(tan-cf (/ pi 4) 9) ; => 1.0 as it should be
(tan-cf (/ (* 3 pi) 4) 15) ; => -1.0
(tan-cf 0 4) ; => 0
(tan-cf pi 15) ; => -1.4135798584282297e-16

(map (λ (k) (tan-cf (/ pi 4) k)) (range 1 10)) ; =>
;;  '(0.7853981633974483
;;  0.988689239934205
;;  0.9997876809149684
;;  0.9999978684156948
;;  0.999999986526355
;;  0.9999999999413254
;;  0.9999999999998131
;;  0.9999999999999994
;;  1.0
;;  1.0)
