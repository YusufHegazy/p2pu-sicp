
(define (RLC R L C dt)
  (Î» (v_C0 i_L0)
    (define v_C (integral (delay dv_C) v_C0 dt))
    (define i_L (integral (delay di_L) i_L0 dt))
    (define dv_C (scale-stream i_L (/ -1 C)))
    (define di_L (add-streams (scale-stream v_C (/ L))
                              (scale-stream i_L (/ (- R) L))))
    (list v_C i_L)))

(define (voltages pair) (first pair))
(define (currents pair) (second pair))

(print-n (voltages ((RLC 1 1 0.2 0.1) 10 0)) 36)
; 10, 10, 9.5, 8.55, 7.220000000000001, 5.5955, 3.77245, 1.8519299999999999, -0.0651605000000004, -1.8831384500000004, -3.5160605800000004, -4.8915335745, -5.95365624055, -6.66498996127, -7.0075074978905, -6.982523782785449, -6.609663064296379, -5.924962228516943, -4.978248323100632, -3.829957696800105, -2.547583716974599, -1.2019492502916387, 0.136500955571756, 1.401203603363393, 2.5326109385972786, 3.480817360139606, 4.2075725925978364, 4.687611433803264, 4.909267761258256, 4.874377884277586, 4.59751360693207, 4.104616863107227, 3.4311341133182642, 2.6197687953528366, 1.7179833035180385, 0.7753879210990783, ... 

(print-n (currents ((RLC 1 1 0.2 0.1) 10 0)) 36)
; 0, 1.0, 1.9, 2.66, 3.249, 3.6461, 3.84104, 3.834181, 3.6359559, 3.2658442599999997, 2.750945989, 2.1242453320999997, 1.4226674414399998, 0.6850350732409998, -0.049967430210100305, -0.7457214369781403, -1.3694016715588713, -1.893427810832622, -2.296581252601054, -2.5647479596510117, -2.691268933365921, -2.676900411726789, -2.529405295583274, -2.262814670467771, -1.8964128430846547, -1.4535104649164614, -0.9600776824108546, -0.4433126549099854, 0.06977975396133962, 0.5537285546910313, 0.9857934876496868, 1.3469654995779252, 1.6227306359308553, 1.8035709836695961, 1.8851907648379203, 1.868470018705932, ... 

;; A nice decaying oscillation...

